{
  "enabled": true,
  "name": "Zalt Security Validator",
  "description": "Validate security best practices on code changes",
  "version": "1",
  "when": {
    "type": "fileSave",
    "pattern": "**/*.{ts,tsx}"
  },
  "then": {
    "type": "askAgent",
    "prompt": "Security validation for Zalt code change:\n\nCHECK FOR:\n1. Token storage issues:\n   - âŒ localStorage for tokens in production\n   - âŒ Tokens in URLs or query params\n   - âœ… httpOnly cookies\n\n2. Sensitive data exposure:\n   - âŒ console.log with passwords/tokens\n   - âŒ Error messages revealing user existence\n   - âœ… Generic error messages\n\n3. MFA implementation:\n   - âš ï¸ SMS MFA without risk acceptance\n   - âœ… TOTP or WebAuthn preferred\n\n4. Input validation:\n   - âŒ Missing email/password validation\n   - âŒ SQL injection vectors\n   - âœ… Proper sanitization\n\n5. Rate limiting:\n   - âŒ Auth endpoints without rate limits\n   - âœ… Proper rate limit headers\n\nIF ISSUES FOUND:\n- List each issue with line number\n- Provide fix recommendation\n- Rate severity: ğŸš¨ Critical, âš ï¸ Warning, â„¹ï¸ Info\n\nIF NO ISSUES:\n- Respond with 'âœ… Security check passed'"
  }
}
